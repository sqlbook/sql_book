<main>
  <div class="page-header">
    <h1>Data Sources</h1>
    <%= link_to new_app_data_source_path, class: "link secondary create-data-source" do %>
      <i class="ri-add-line red-500"></i>
      <span>Create New</span>
    <% end %>
  </div>

  <div class="data-sources container lg">
    <%= render "shared/data_source_card", data_source: @data_source %>
  </div>
</main>

<aside data-controller="resizeable-page">
  <div class="tabs">
    <%= render "shared/tabs/nav_item", tab: "source_url", name: "Source URL", icon_class: "ri-global-line", default_selected: true %>
    <%= render "shared/tabs/nav_item", tab: "tracking_code", name: "Tracking Code", icon_class: "ri-fire-line" %>
  </div>

  <% if active_tab?(tab: "source_url", default_selected: true) %>
    <div data-controller="form">
      <%= form_with url: app_data_source_path(@data_source), method: :put, class: "update-data-source-form", html: { "data-form-target": "form" } do |form| %>
        <%= form.label :url, "URL", class: "label block" %>
        <%= form.text_field :url, type: "url", placeholder: "https://", class: "input block fluid", required: true, pattern: "https://.*", value: @data_source.url %>

        <%= render "shared/flash" %>

        <%= form.submit "[Save Changes]", class: "link primary", "data-form-target": "submit" %>
      <% end %> 
    </div>
  <% end %>

  <% if active_tab?(tab: "tracking_code") %>
    <%= render "shared/tracking_code", data_source: @data_source %>
  <% end %>

  <%= render "shared/grab_handle" %>
</aside>
